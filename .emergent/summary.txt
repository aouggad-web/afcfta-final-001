<analysis>**original_problem_statement:**
L'utilisateur souhaite créer une application d'analyse commerciale de haute précision pour l'Afrique. La demande initiale, qui concernait l'enrichissement d'une base de données de codes HS6, a évolué vers une refonte complète de la base de données à partir d'un fichier CSV fourni par l'utilisateur. De plus, l'utilisateur a demandé d'intégrer deux nouvelles fonctionnalités majeures :
1.  Lier chaque code HS aux Règles d'Origine (RoO) spécifiques au produit de la ZLECAf.
2.  Créer un outil pour rechercher les statistiques de commerce international (import/export par pays, année et produit) en s'intégrant à l'API publique de l'OEC (Observatory of Economic Complexity).

Au cours des sessions, l'utilisateur a ajouté plusieurs exigences :
-   Ajouter les volumes (quantités) aux statistiques commerciales de l'OEC.
-   Uniformiser l'utilisation des codes pays ISO3.
-   Afficher les drapeaux des pays.
-   Corriger de nombreux bugs dans le nouveau composant de statistiques OEC.
-   S'assurer que la base de données complète de plus de 5000 codes SH6 est fonctionnelle.
-   **Dernières requêtes :**
    -   Corriger l'affichage des taux de taxes et des références légales dans le tableau récapitulatif du calculateur. (Terminé)
    -   **Corriger une erreur critique dans l'affichage des Règles d'Origine**, qui sont génériques au lieu d'être spécifiques au produit. (En cours)

**PRODUCT REQUIREMENTS:**
-   **Base de Données HS Complète**: La base de données doit contenir l'ensemble des codes HS6 (SH2022), bilingues (FR/EN). (Terminé)
-   **Intégration des Règles d'Origine (RoO) Spécifiques**: Les données des codes HS doivent être enrichies avec les RoO **officielles et spécifiques au produit** de la ZLECAf. (En cours de correction)
-   **Intégration des Statistiques Commerciales OEC**: L'application doit fournir des points de terminaison API et une interface utilisateur pour récupérer et visualiser les données commerciales depuis l'API de l'OEC. (Terminé)
-   **Indicateur de fraîcheur des données**: Afficher quand les données ont été mises à jour pour la dernière fois. (En attente)
-   **Poursuivre la migration i18n**: Continuer la migration des composants frontend vers . (Partiellement terminé)

**User's preferred language**: French. The next agent MUST respond in French.

**what currently exists?**
L'application dispose d'un backend FastAPI et d'un frontend React. Le backend a été significativement refactorisé : le fichier monolithique  a été décomposé en un répertoire de  modulaires (, , , , , ). La logique partagée (modèles Pydantic, constantes, traductions) a également été extraite dans des modules dédiés. La base de données en mémoire de ~5800 codes SH6 est fonctionnelle. Côté frontend, le composant  a été migré vers  pour l'internationalisation. Le bug d'affichage du nombre de codes dans le calculateur a été résolu, ainsi qu'un bug d'affichage des taux de taxes et des références légales dans les résultats du calculateur.

**Last working item**:
-   **Last item agent was working**: L'agent travaillait sur la correction d'un bug critique signalé par l'utilisateur : le calculateur affichait une Règle d'Origine (RoO) générique (35% valeur ajoutée africaine) pour tous les produits, au lieu de la règle spécifique au produit issue de l'accord de la ZLECAf. L'utilisateur a explicitement demandé de lier les ~5800 codes SH6 à la base de données officielle du secrétariat de l'UA ZLECAf. L'agent a commencé la correction en créant un nouveau fichier  et en modifiant l'endpoint pour qu'il l'utilise, mais le contenu de ce nouveau fichier n'a pas encore été peuplé avec les règles correctes.
-   **Status**: IN PROGRESS
-   **Agent Testing Done**: N
-   **Which testing method agent to use?**: Both. Le backend doit être testé via  pour vérifier que l'API  renvoie la règle spécifique au produit. Le frontend doit être testé via l'outil de capture d'écran pour confirmer que le composant  affiche la bonne règle après un calcul.
-   **User Testing Done**: N (L'utilisateur a signalé le bug).

**All Pending/In progress Issue list**:
-   **Issue 1: Les Règles d'Origine dans le calculateur sont incorrectes et génériques (P0)**
    -   **Attempted fixes**: L'agent a créé un nouveau fichier de données  et a modifié la route  dans  pour qu'elle l'utilise.
    -   **Next debug checklist**:
        1.  Rechercher et trouver une source de données fiable pour les Règles d'Origine spécifiques de la ZLECAf (Annexe 2 de l'accord).
        2.  Peupler le fichier  avec ces données structurées, en associant chaque code HS6 (ou chapitre/position parent) à sa règle spécifique (ex: Changement de position tarifaire, Contenu à valeur régionale de X%, etc.).
        3.  Implémenter la logique dans la fonction  pour rechercher et renvoyer la règle la plus spécifique disponible pour un code donné.
        4.  Tester l'endpoint API  pour s'assurer que le journal de calcul contient la règle d'origine correcte.
        5.  Tester l'interface utilisateur du calculateur pour vérifier l'affichage de la règle correcte.
    -   **Why fix this issue and what will be achieved with the fix?**: C'est une erreur de données critique qui remet en cause la fiabilité et l'utilité principale de l'application. La corriger est essentiel pour la crédibilité de l'outil.
    -   **Status**: IN PROGRESS
    -   **Is recurring issue?**: N
    -   **Should Test frontend/backend/both after fix?**: Both.
    -   **Blocked on other issue**: None.

**In progress Task List**:
-   **Task 1: Finaliser le refactoring du backend (P1)**
    -   **Where to resume**: Les routes pour , , et  ont été créées en tant que fichiers, mais les endpoints correspondants n'ont pas encore été complètement supprimés de . Le refactoring est à mi-chemin.
    -   **What will be achieved with this?**: Un code backend entièrement modulaire, plus facile à maintenir et à faire évoluer. Le fichier  ne servira plus qu'à la configuration et à l'initialisation de l'application.
    -   **Status**: IN PROGRESS
    -   **Should Test frontend/backend/both after fix?**: Backend (test de régression complet des APIs).
    -   **Blocked on something**: Issue 1 (P0). Doit être repris après la correction du bug critique.

**Upcoming and Future Tasks**
-   **Upcoming Tasks:**
    -   **Indicateur de fraîcheur des données (P1)**: Mettre en œuvre une fonctionnalité pour ajouter un horodatage dernière vérification pour les données critiques.
    -   **Recherche/Filtre pour le fil d'actualités (P1)**: Ajouter une barre de recherche au fil d'actualités.
    -   **Refactoring Frontend  (P2)**: Décomposer le composant monolithique en sous-composants plus petits et gérables.
-   **Future Tasks:**
    -   **Sécuriser l'upload TRS pour les administrateurs (P2)**.
    -   **Exportation de données CSV/Excel (P2)**.
    -   **Fonction de comparaison de pays (P2)**.
    -   **Sauvegarder les recherches HS fréquentes (P2)**.

**Completed work in this session**
-   **Refactoring Majeur du Backend (Phase 1)**: Décomposition du fichier  en un répertoire  modulaire. Migration des endpoints , , , ,  et . Création de modules partagés (, , ). La taille de  a été réduite de plus de 1000 lignes.
-   **Bug Fix: Affichage dans le Calculateur**: Correction du tableau récapitulatif pour afficher correctement les taux de taxes (ex: 20.0%) et ajout des références légales dans le journal de calcul détaillé.
-   **Bug Fix: Compteur de Codes HS**: Correction des endpoints du backend pour utiliser la base de données complète, faisant passer le compteur de 731 à 5831 codes SH6 dans le navigateur de codes.
-   **Migration i18n Frontend**: Le composant  a été migré avec succès pour utiliser .

**Earlier issues found/mentioned but not fixed**
-   Aucun. Les tâches en attente sont listées dans Upcoming and Future Tasks.

**Known issue recurrence from previous fork**
-   None.

**Code Architecture**


**Key Technical Concepts**
-   Backend: FastAPI, Pydantic, MongoDB
-   Frontend: React, Shadcn UI, Recharts, 
-   Data: Dictionnaires Python en mémoire, JSON
-   Architecture: Refactoring vers une architecture de routes modulaires.

**key DB schema**
-   **** (in-memory dict in ): Contient ~5800 codes SH6 bilingues et leurs métadonnées.
-   **** (in-memory dict in ): **À créer/peupler**. Doit contenir les règles d'origine spécifiques par produit.
-   **MongoDB**: Utilisé pour certaines données comme .

**changes in tech stack**
-   Aucune nouvelle dépendance. Le travail s'est concentré sur le refactoring et la correction de bugs.

**All files of reference**
-   **/app/backend/etl/afcfta_rules_of_origin.py**: **CRITIQUE**. Le fichier à peupler pour corriger le bug des Règles d'Origine.
-   **/app/backend/routes/tariffs.py**: Contient l'endpoint  qui dépend de la correction ci-dessus.
-   **/app/frontend/src/components/calculator/CalculatorTab.jsx**: L'interface utilisateur où le bug des Règles d'Origine et le bug d'affichage des taxes ont été signalés.
-   **/app/backend/server.py**: Fichier central en cours de refactoring, contient encore des routes à migrer.

**Areas that need refactoring**:
-   **Backend**: Le refactoring des routes depuis  est en cours et doit être terminé pour les modules ,  et .
-   **Frontend**: Le composant  (>800 lignes) est un candidat prioritaire pour être décomposé en sous-composants, bien que la structure de dossiers ait été créée, le travail n'a pas commencé.

**key api endpoints**
-   : Endpoint principal du calculateur, qui doit inclure la Règle d'Origine spécifique et correcte.
-   : Endpoint qui doit renvoyer la RoO spécifique pour un produit.
-   Tous les autres endpoints sont en cours de migration vers le répertoire .

**Critical Info for New Agent**
-   La priorité absolue (P0) est la correction du bug des Règles d'Origine. L'utilisateur a identifié cela comme une erreur fondamentale. Il ne suffit pas de changer une chaîne de caractères, il faut implémenter la logique correcte en se basant sur les règles officielles de la ZLECAf, qui varient par produit. Le fichier  a été créé mais est probablement vide ; il doit être rempli avec les données réelles.
-   Après la résolution du bug P0, la tâche suivante devrait être de finaliser le refactoring du backend en migrant les routes restantes (, , ) hors de .
-   L'utilisateur est attentif et fournit des retours techniques précis. Il est crucial de valider chaque correction en profondeur.

**documents and test reports created in this job**
-    (mis à jour)
-   Nouvelle structure de fichiers dans .
-   Nouveaux modules : , , .

**Last 10 User Messages and any pending HUMAN messages**
1.  **User**: Signale que les taux de droits de douane et autres taxes ne sont pas affichés, et que les références légales manquent dans le tableau récapitulatif du calculateur. (Status: **RESOLVED**)
2.  **User**: Signale une erreur critique : la règle d'origine affichée pour le blé est 35% valeur ajoutée africaine, ce qui est incorrect. Demande de lier les ~5000 codes SH6 à la base de données du secrétariat de l'UA ZLECAf pour afficher les règles spécifiques à chaque produit. (Status: **IN PROGRESS**, c'est le bug P0 actuel)

**Project Health Check:**
-   **Working**: L'application est fonctionnelle, mais le refactoring du backend est inachevé et il existe un bug critique de justesse des données dans une fonctionnalité clé (Règles d'Origine).

**3rd Party Integrations**
-   
-   
-    & 
-   
-   
-   

**Testing status**
-   **Testing agent used after significant changes**: NO (non requis pour le refactoring et les bugs récents).
-   **Troubleshoot agent used after agent stuck in loop**: NO.
-   **Test files created**: None.
-   **Known regressions**: None.

**Credentials to test flow:**
-   N/A

**What agent forgot to execute**
-   L'agent a créé le fichier  mais n'a pas implémenté la partie la plus importante : le peuplement de ce fichier avec les données réelles et spécifiques des Règles d'Origine.
-   Le refactoring de  a été bien entamé mais n'est pas terminé.
-   Le refactoring du composant  a été planifié (création de dossiers) mais pas exécuté.</analysis>
